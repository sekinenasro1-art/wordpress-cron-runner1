name: ğŸš€ Auto-Open WordPress Pages
on:
  schedule:
    - cron: '*/5 * * * *'
  workflow_dispatch:

jobs:
  open-pages:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ”„ Start automatic page opening
        run: |
          echo "=============================================="
          echo "ğŸš€ STARTING AUTOMATIC PAGE OPENING"
          echo "Time: $(date)"
          echo "=============================================="

      - name: ğŸ“„ Open First Page (Bulletproof)
        run: |
          echo "1ï¸âƒ£ OPENING: https://tst1.xo.je/?wp_automatic=cron"
          echo "ğŸ›¡ï¸ Using bulletproof method..."
          
          # Method 1: Try with timeout and ignore ALL errors
          timeout 30s curl -s -k -L --max-time 25 --retry 2 --retry-delay 5 \
            -w "HTTP Status: %{http_code} | Time: %{time_total}s | Bytes: %{size_download}" \
            -o /tmp/page1.html \
            "https://tst1.xo.je/?wp_automatic=cron" && echo "âœ… Request completed" || echo "âš ï¸ Request attempted (errors ignored)"
          
          # Method 2: Alternative approach
          echo "ğŸ”„ Alternative method..."
          curl -s -k --connect-timeout 10 --max-time 15 \
            "https://tst1.xo.je/?wp_automatic=cron" > /dev/null 2>&1 && echo "âœ… Alternative method worked" || echo "âš ï¸ Alternative method attempted"
          
          echo "ğŸ“Š First page opening attempted"
          echo "---"

      - name: â³ Wait 5 Seconds
        run: |
          echo "â³ Waiting 5 seconds between pages..."
          sleep 5
          echo "---"

      - name: ğŸ“„ Open Second Page (Bulletproof)
        run: |
          echo "2ï¸âƒ£ OPENING: https://tst1.xo.je/wp-cron.php"
          echo "ğŸ›¡ï¸ Using bulletproof method..."
          
          # Method 1: Try with timeout and ignore ALL errors
          timeout 30s curl -s -k -L --max-time 25 --retry 2 --retry-delay 5 \
            -w "HTTP Status: %{http_code} | Time: %{time_total}s | Bytes: %{size_download}" \
            -o /tmp/page2.html \
            "https://tst1.xo.je/wp-cron.php?doing_wp_cron%20%3E%20/dev/null%202%3E&1" && echo "âœ… Request completed" || echo "âš ï¸ Request attempted (errors ignored)"
          
          # Method 2: Alternative approach
          echo "ğŸ”„ Alternative method..."
          curl -s -k --connect-timeout 10 --max-time 15 \
            "https://tst1.xo.je/wp-cron.php?doing_wp_cron%20%3E%20/dev/null%202%3E&1" > /dev/null 2>&1 && echo "âœ… Alternative method worked" || echo "âš ï¸ Alternative method attempted"
          
          echo "ğŸ“Š Second page opening attempted"
          echo "---"

      - name: âœ… Completion Summary
        run: |
          echo "=============================================="
          echo "ğŸ‰ EXECUTION COMPLETED - REQUESTS WERE SENT"
          echo "Time: $(date)"
          echo "Status: âœ… URLs were contacted (regardless of server response)"
          echo "Next run: In 5 minutes"
          echo "=============================================="
