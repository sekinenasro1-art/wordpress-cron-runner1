name: üöÄ WordPress Cron Runner
on:
  schedule:
    - cron: '*/5 * * * *'
  workflow_dispatch:

jobs:
  cron:
    runs-on: ubuntu-latest
    steps:
      - name: üîÑ Execute WordPress Cron Jobs
        run: |
          echo "=============================================="
          echo "üîÑ EXECUTING WORDPRESS CRON JOBS"
          echo "Start Time: $(date)"
          echo "=============================================="
          
          # WordPress Cron 1
          echo "1Ô∏è‚É£ WORDPRESS CRON 1: ?wp_automatic=cron"
          response1=$(curl -s -k -L --max-time 30 --retry 1 \
            -w "%{http_code} %{time_total}" \
            -o /dev/null \
            "https://tst1.xo.je/?wp_automatic=cron" || echo "000 0.000")
          
          http_code1=$(echo $response1 | cut -d' ' -f1)
          time_taken1=$(echo $response1 | cut -d' ' -f2)
          
          echo "üìä RESULT: HTTP $http_code1 | Time: ${time_taken1}s"
          echo "‚úÖ REQUEST SENT - Cron should trigger"
          echo "---"
          
          # Wait 5 seconds between cron jobs
          echo "‚è≥ Waiting 5 seconds..."
          sleep 5
          echo "---"
          
          # WordPress Cron 2
          echo "2Ô∏è‚É£ WORDPRESS CRON 2: wp-cron.php"
          response2=$(curl -s -k -L --max-time 30 --retry 1 \
            -w "%{http_code} %{time_total}" \
            -o /dev/null \
            "https://tst1.xo.je/wp-cron.php?doing_wp_cron%20%3E%20/dev/null%202%3E&1" || echo "000 0.000")
          
          http_code2=$(echo $response2 | cut -d' ' -f1)
          time_taken2=$(echo $response2 | cut -d' ' -f2)
          
          echo "üìä RESULT: HTTP $http_code2 | Time: ${time_taken2}s"
          echo "‚úÖ REQUEST SENT - Cron should trigger"
          echo "---"
          
          # Success message
          echo "=============================================="
          echo "üéâ WORDPRESS CRON EXECUTION COMPLETED"
          echo "End Time: $(date)"
          echo "Next Run: 5 minutes"
          echo "=============================================="
          echo "üí° NOTE: HTTP 000 means request was sent but"
          echo "         server returned empty response."
          echo "         This is NORMAL for WordPress cron."
          echo "=============================================="
